\chapter{Cryptography}

Authentication, Integrity, and Confidentiality are the three objectives of secure communications. Authentication guarantees that a message comes from the source that it claims to come from. Integrity ensures that messages are not altered in transit. Confidentiality ensures so that only the receiver can read the message.\\

Encryption and hashing are used to make certain that only authorized entities can read the message (Confidentiality). The receiver can verify that the received message is identical to the sent message and that no manipulation occurred (Integrity). \\



\section{Hash function}

A hash function takes the message and produces a fixed-length and condensed bit string, called the hash value or message digest. Hashing is based on a one-way mathematical function that is relatively easy to compute, but significantly harder to reverse. The cryptographic hashing function can provide proof of authenticity (IPsec, routing protocol, CHAP) and message integrity check proof.\\

MD5 produces a 128-bit hashed message digest and is now considered a legacy algorithm.\\

The SHA-1 algorithm produces a 160-bit message digest and is slightly slower than MD5, but the larger message digest makes it more secure against brute-force collision and inversion attacks. SHA-1 is now considered to be a legacy algorithm. It is recommended to use the SHA-2 family of hash functions, which are SHA-224 (224 bit), SHA-256 (256 bit), SHA-384 (384 bit), SHA-512 (512 bit). \\

A keyed-hash message authentication code (HMAC or KHMAC) use a secret key as input to the hash function. This adds authentication to integrity assurance. The mechanism of HMAC is that two parties share a secret key and use HMAC functions for authentication. Only parties who have access to that secret key can compute the digest of an HMAC function. This characteristic defeats man-in-the-middle attacks. Cisco technologies use two well-known HMAC functions: legacy Keyed MD5 (HMAC-MD5) and Keyed SHA-1 (HMAC-SHA-1).\\

Two terms that are used to describe keys are: Key length (key size) and Keyspace (the number of possibilities that can be generated by a specific key length). As key length increase, the keyspace increases exponentially, which affects the time it takes to crack the code. Longer keys are more secure; however, they are also more resource intensive.

\section{Encryption}

Cryptographic encryption can provide confidentiality at several layers of the OSI model. For example, the IPsec for network layer protocols. Secure Sockets Layer (SSL) or Transport Layer Security (TLS), provide session layer confidentiality. MD5, Keyed MD5, and Secure Hash Algorithm 1 are examples of hash functions. They provide data integrity but not data confidentiality.\\

There are two classes of encryption algorithms: Symmetric algorithms and Asymmetric algorithms.

\subsection{Symmetric algorithms}

Symmetric algorithms use the same pre-shared key on both parties and the key is shorter, meaning faster execution. The encryption and decryption keys are the same. The sender and the receiver must exchange the secret key using a secure channel before any encryption can occur. By obtaining the key, anyone can encrypt and decrypt messages. DES, 3DES, AES, Software Encryption Algorithm (SEAL), and the Rivest ciphers (RC) series are all well-known encryption algorithms that use symmetric keys.\\

The most commonly used techniques in symmetric encryption cryptography are block ciphers and stream ciphers. Block ciphers transform a fixed-length block of plaintext into a common block of ciphertext of 64 or 128 bits. Unlike block ciphers, stream ciphers encrypt plaintext one byte or one bit at a time.\\

Two main criteria that should be considered when selecting an encryption algorithm for an organization: The algorithm is trusted by the cryptographic community, The algorithm adequately protects against brute-force attacks.\\

%Data Encryption Standard (DES) is a block cipher that uses 64bit key, of which 56 bits are used for encryption. The remaining 8 bits are used for parity. When forced to use DES, change keys frequently, use a secure channel to communicate the DES key, and use cipher block chaining (CBC) mode.â€‹ \\ 

One way to increase the DES effective key length is to use the same algorithm with different keys several times in a row. The technique of applying DES three times in a row to a plaintext block is called 3DES. The Cisco IPsec implementation uses DES and 3DES in CBC mode.\\

Although 3DES is very secure, it is also resource intensive. To better manage resources, AES was chosen to replace DES. It has stronger key and runs faster than DES. Despite these advantages, AES is a relatively young algorithm. A mature algorithm, like 3DES, is always more trusted.\\

The Software-Optimized Encryption Algorithm (SEAL) is a stream cipher that uses a 160-bit encryption key. Because it is a stream cipher, data to be encrypted is continuously encrypted, which makes it much faster than block ciphers. SEAL has several restrictions: IPsec and Security version IOS are required, The router and the peer must not have hardware IPsec encryption.\\

The stream cipher RC4 is often used in file encryption products and for secure communications, such as within SSL. It can be implemented insecurely, as in Wired Equivalent Privacy (WEP). RC5 is a fast block cipher that can be used as a drop-in replacement for DES if the block size is set to 64-bit. RC6 is a 128-bit to 256-bit block cipher that is based on RC5 and was designed to meet the requirement of AES.\\

\subsection{Asymmetric algorithms}

Asymmetric algorithms use different keys to encrypt and decrypt data. One key is called the private key, and the other is the public key. The private key is secret and known only to the user. The public key is openly shared and easily distributed. Secure messages can be exchanged without having to have a pre-shared key. Because neither party has a shared secret, very long key lengths must be used. These algorithms are resource intensive and slower to execute. Some well-known asymmetric algorithms: DH, RSA, DSS,	DSA. Asymmetric algorithms are slow, so they are commonly used in low-volume transactions such as making online purchases or logging into a financial website.\\

\textbf{Diffie-Hellman (DH)} Algorithm allows two computers to generate an identical shared secret on both systems, without having communicated before.  To start a DH exchange, both hosts must agree on two nonsecret numbers. The first number is a base number, also called the generator. The second number is a prime number that is used as the modulus. DH is commonly used in IKE (fundamental component of IPsec VPNs), SSL, TLS, and SSH. It is common to use DH algorithm to create and exchange pre-shared keys for symmetric algorithm (3DES or AES).\\

\textbf{Digital signatures} are commonly used in Code signing and Digital certificate. Code signing verifies the integrity of executable files downloaded from a vendor website. Digital certificates verify the identity of a vendor website and establish an encrypted connection. Digital signatures provide three basic security services: Authenticity, Integrity, and Nonrepudiation of the transaction\footnote{Nonrepudiation uses the unique characteristics of the sender of a message to confirm that the reputed sender is in fact the actual sender.}.\\

The \textbf{Public Key Infrastructure (PKI)} identifies a certificate authority which issues public key (certificates) for asymmetric algorithm. The PKI also identifies the encryption algorithms, levels of security, and distribution policy to users. \textbf{X.509} is a well-known standard that defines basic PKI formats. The X.509 version 3 (X.509v3) standard defines the format of a digital certificate. Another important set of PKI standards are the \textbf{Public-Key Cryptography Standards (PKCS}). PKCS defines the low-level formats for the secure exchange of arbitrary data, such as an encrypted piece of data or a signed piece of data.\\

